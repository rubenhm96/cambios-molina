var drop;jQuery(function(t){t("body").on("init",".rl-tabs-wrapper, .restaurant-listings-tabs",function(){t(".rl-tab, .restaurant-listings-tabs .panel:not(.panel .panel)").hide();var e=window.location.hash,i=window.location.href,a=t(this).find(".rl-tabs, ul.tabs").first();e.toLowerCase().indexOf("comment-")>=0||"#reviews"===e||"#tab-reviews"===e?a.find("li.reviews_tab a").click():i.indexOf("comment-page-")>0||i.indexOf("cpage=")>0?a.find("li.reviews_tab a").click():"#tab-additional_information"===e?a.find("li.additional_information_tab a").click():a.find("li:first a").click()}).on("click",".rl-tabs li a, ul.tabs li a",function(e){e.preventDefault();var i=t(this),a=i.closest(".rl-tabs-wrapper, .restaurant-listings-tabs");a.find(".rl-tabs, ul.tabs").find("li").removeClass("active"),a.find(".rl-tab, .panel:not(.panel .panel)").hide(),i.closest("li").addClass("active"),a.find(i.attr("href")).show()}).on("click","a.restaurant-listings-review-link",function(){return t(".reviews_tab a").click(),!0}).on("init","#rating",function(){t("#rating").hide().before('<p class="stars"><span><a class="star-1" href="#">1</a><a class="star-2" href="#">2</a><a class="star-3" href="#">3</a><a class="star-4" href="#">4</a><a class="star-5" href="#">5</a></span></p>')}).on("click","#respond p.stars a",function(){var e=t(this),i=t(this).closest("#respond").find("#rating"),a=t(this).closest(".stars");return i.val(e.text()),e.siblings("a").removeClass("active"),e.addClass("active"),a.addClass("selected"),!1}).on("click","#respond #submit",function(){t(this).closest("#respond").find("#rating").val()}).one("click",".menu_tab",function(){t(".restaurant-menu").slick("getSlick").refresh()}),t(".rl-tabs-wrapper, .restaurant-listings-tabs, #rating").trigger("init"),t(".business-hours-drop-wrapper").each(function(e,i){let a,s=t(this),n=s.find(".business-hour").toArray(),r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][(new Date).getDay()],o=n.find(function(t,e,i){return t.getAttribute("data-day")===r});void 0!==o?(o.classList.add("restaurant-bold"),a=o.childNodes[3].innerHTML):a=" - "+restaurant_listings_vars.l10n.close,s.find(".today.business-hours > .business-hour-time")[0].innerHTML=a,drop=new Drop({target:s.find(".business-hours-drop-btn")[0],content:s.find(".business-hours-drop-element")[0],position:"bottom left",openOn:"click",classes:"drop-theme-arrows"})});var e=function(e,i){this.$target=e,this.$window=t(window),this.flexslider={vars:{}},this.initPhotoslider=this.initPhotoslider.bind(this),this.getGridSize=this.getGridSize.bind(this),this.initPhotoslider()};e.prototype.initPhotoslider=function(){var t=this,e=t.$target;this.$window.load(function(){e.slick({centerMode:!0,centerPadding:"60px",slidesToShow:3,responsive:[{breakpoint:768,settings:{arrows:!1,centerMode:!0,centerPadding:"40px",slidesToShow:3}},{breakpoint:480,settings:{arrows:!1,centerMode:!0,centerPadding:"40px",slidesToShow:1}}]})}),this.$window.resize(function(){var i=e.getGridSize;t.flexslider.vars.minItems=i,t.flexslider.vars.maxItems=i})},e.prototype.getGridSize=function(){return window.innerWidth<600?2:window.innerWidth<900?3:4},t.fn.restaurant_photo_slider=function(t){return new e(this,t),this},t(".restaurant-gallery-images").each(function(){t(this).restaurant_photo_slider()});var i=function(e,i){this.$target=e,this.$window=t(window),this.$images=t(".gallery-preview-image",e),0!==this.$images.length?(e.data("photo_gallery",this),this.initPhotoswipe=this.initPhotoswipe.bind(this),this.getGalleryItems=this.getGalleryItems.bind(this),this.openPhotoswipe=this.openPhotoswipe.bind(this),this.$target.css("opacity",1),this.initPhotoswipe()):this.$target.css("opacity",1)};i.prototype.initPhotoswipe=function(){this.$target.on("click",".restaurant-gallery__item-trigger",this.openPhotoswipe)},i.prototype.getGalleryItems=function(){var e=this.$images,i=[];return e.length>0&&e.each(function(e,a){var s=t(a).find("img"),n={src:s.attr("data-large_image"),w:s.attr("data-large_image_width"),h:s.attr("data-large_image_height"),title:s.attr("data-caption")?s.attr("data-caption"):s.attr("title")};i.push(n)}),i},i.prototype.openPhotoswipe=function(e){e.preventDefault();var i=t(".pswp")[0],a=this.getGalleryItems(),s=t(e.target),n=0;s.is(".restaurant-gallery__item-trigger")||(n=s);var r=t.extend({index:t(n).index(".restaurant-gallery-images img")},{closeOnScroll:!1,hideAnimationDuration:0,history:!1,shareEl:!1,showAnimationDuration:0});new PhotoSwipe(i,PhotoSwipeUI_Default,a,r).init()},t.fn.restaurant_photo_gallery=function(t){return new i(this,t),this},t(".restaurant-gallery-images").each(function(){t(this).restaurant_photo_gallery()});var a=function(e,i){this.$target=e,this.$window=t(window),this.initSlickSlider=this.initSlickSlider.bind(this),this.initSlickSlider()};a.prototype.initSlickSlider=function(){const t=this.$target;this.$window.load(function(){t.slick({lazyLoad:"ondemand",slidesToShow:1,slidesToScroll:1})})},t.fn.restaurant_menu=function(t){return new a(this,t),this},t(".restaurant-menu").each(function(){t(this).restaurant_menu()})}),window.onload=(()=>{document.getElementById("restaurant-locator-map")&&(mapboxgl.accessToken=restaurant_listings_vars.access_token,restaurantMapBox.init())});const restaurantMapBox={container:"restaurant-locator-map",style:"mapbox://styles/mapbox/streets-v9",zoom:14,lastGeocode:void 0,init(){this.map=new mapboxgl.Map({container:this.container,style:this.style,zoom:this.zoom}),this.map.on("load",t=>this.loadMap()),navigator.geolocation.getCurrentPosition(t=>this.showNearByRestaurant(t))},loadMap(){this.map.addControl(new mapboxgl.NavigationControl),this.map.on("dragend",t=>this.dragEndOnMap(t)),this.addGeocoder()},addGeocoder(){this.geocoder=new MapboxGeocoder({accessToken:mapboxgl.accessToken}),this.geocoder.on("result",t=>this.geocoderResult(t)),this.map.addControl(this.geocoder,"top-left")},geocoderResult(t){if(t.result.center.toString()!==this.lastGeocode){let e=t.result.center[0],i=t.result.center[1];this.getNearbyRestaurant(e,i,!0)}this.lastGeocode=t.result.center.toString()},dragEndOnMap(t){const e=t.target.transform._center;this.getNearbyRestaurant(e.lng,e.lat)},showNearByRestaurant(t){let[e,i]=[t.coords.longitude,t.coords.latitude];this.map.setCenter([e,i]),this.getNearbyRestaurant(e,i)},fillRestaurantDate(t){t.forEach((t,e)=>{let i=document.createElement("div");i.id="marker-"+e,i.className="marker",new mapboxgl.Marker(i,{offset:[-28,-46]}).setLngLat(t.geometry.coordinates).addTo(this.map),i.addEventListener("click",i=>this.clickMarkerOnMap(i,t,e))})},clickMarkerOnMap(t,e,i){this.flyToStore(e),this.createPopUp(e);let a=document.getElementsByClassName("active");t.stopPropagation(),a[0]&&a[0].classList.remove("active"),document.getElementById("listings-"+i).classList.add("active")},flyToStore(t){this.map.flyTo({center:t.geometry.coordinates,zoom:15})},createPopUp(t){let e=document.getElementsByClassName("mapboxgl-popup");e[0]&&e[0].remove();new mapboxgl.Popup({closeOnClick:!1}).setLngLat(t.geometry.coordinates).setHTML('<div><a href="#">'+t.properties.name+"</a></div><p>"+t.properties.address+"</p>").addTo(this.map)},buildLocationList(t){for(let e=0;e<t.length;e++){let i=t[e],a=i.properties,s=document.getElementById("listings");(s=s.appendChild(document.createElement("div"))).className="item",s.id="listings-"+e;let n=s.appendChild(document.createElement("button"));n.className="card-button",n.dataPosition=e;let r=s.appendChild(document.createElement("a"));r.href="#",r.className="title",r.innerHTML=a.name;let o=s.appendChild(document.createElement("div"));o.innerHTML=a.address,a.phone&&(o.innerHTML+=" &middot; "+a.phoneFormatted),n.addEventListener("click",t=>this.clickMarkerOnMap(t,i,e))}},resetLocationList(){document.querySelector("#listings").innerHTML=""},getNearbyRestaurant(t,e,i=!1){jQuery.ajax({url:restaurant_listings_vars.ajax_url,type:"GET",data:{action:"restaurant_listings_locate_restaurant",origLat:e,origLng:t},success:t=>{i&&this.setMapBounds(t),this.fillRestaurantDate(t),this.resetLocationList(),this.buildLocationList(t)}})},setMapBounds(t){let e=[];t.forEach((t,i)=>{e.push(t.geometry.coordinates)});let i=e.reduce(function(t,e){return t.extend(e)},new mapboxgl.LngLatBounds(e[0],e[0]));this.map.fitBounds(i,{padding:30})}};